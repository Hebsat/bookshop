
<!--END-->
<!--END--><!DOCTYPE html><!--[if IE 7]>
<html class="ie7" lang="ru">
<![endif]-->
<!--[if IE 8]>
<html class="ie8" lang="ru">
<![endif]-->
<!--[if IE 9]>
<html class="ie9" lang="ru">
<![endif]-->
<!--[if gt IE 9]><!--> <html lang="ru" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"> <!--<![endif]-->
<head th:replace="~{fragments/common_head_fragment :: headFragment}"></head>
<body class="Site">
  <!--if lt IE 8
  p.error-browser
      | Ваш браузер&nbsp;
      em устарел!&nbsp;
      a(href="http://browsehappy.com/") Выберите новую версию
          +s
          | браузера здесь&nbsp;
      | для правильного отображения сайта.
  -->
  <header th:replace="~{fragments/common_header_fragment :: headerFragment}"></header>
  <div class="Middle">
    <div class="wrap">
      <main class="Middle-main" th:object="${book}">
        <ul class="breadcrumbs">
          <li class="breadcrumbs-item"><a href="/index.html" th:href="@{/}" th:text="#{bookshop.names.main}">Главная</a>
          </li>
          <li class="breadcrumbs-item"><a href="/genres/index.html" th:href="@{/genres}" th:text="#{bookshop.names.books}">Книги</a>
          </li>
          <li class="breadcrumbs-item breadcrumbs-item_current"><span th:text="${book.title}">Book title</span>
          </li>
        </ul>
        <div class="Product">
          <div class="ProductCard">
            <div class="ProductCard-look">
              <form id="imgForm" method="POST" enctype="multipart/form-data" action="#"
                    th:action="@{/books/{slug}/img/save (slug=${book.slug})}">
                <div class="ProductCard-photo" id="uploadButton">
                  <img src="/assets/img/content/main/card.jpg" th:src="${book.image}" alt="card.jpg"/>
                </div>
                <input type="file" name="file" id="dialog" style="display: none" accept="image/*">
              </form>
            </div>
            <div class="ProductCard-desc">
              <div class="ProductCard-header">
                <h1 class="ProductCard-title" th:text="${book.title}">Book title
                </h1>
                <div class="ProductCard-author" th:each="author, state : ${book.authorList}">
                  <span class="ProductCard-titleProp"
                        th:if="${state.first}"
                        th:text="${state.size gt 1} ?
                                 #{bookshop.names.book_page.authors} :
                                 #{bookshop.names.book_page.author}">Автор:</span>&#32;
                  <a href="#"
                     th:href="@{/authors/{slug} (slug=${author.slug})}"
                     th:text="${author.name}">Author name</a>
                </div>
                <div class="ProductCard-rating">
                  <span class="ProductCard-titleProp" th:text="#{bookshop.names.book_page.rating}">Рейтинг:</span>
                  <button class="trigger trigger_dropdown" type="button">
                    <div class="Rating Rating_noStyleLink">
                      <span class="Rating-stars">
                        <span class="Rating-star Rating-star_view" th:each="star : ${book.ratings.getStars()}"
                              th:class="'Rating-star' + (${star} ? ' Rating-star_view' : '')">
                          <svg xmlns="http://www.w3.org/2000/svg" width="19" height="18" viewBox="0 0 19 18">
                            <g>
                              <path fill="#ffc000" d="M9.5 14.925L3.629 18l1.121-6.512L0 6.875l6.564-.95L9.5 0l2.936 5.925 6.564.95-4.75 4.613L15.371 18z"></path>
                            </g>
                          </svg>
                        </span>
                      </span>
                      <span class="Rating-title" th:text="'(' + ${book.ratings.totalRatings} + ')'">(567)</span>
                    </div>
                    <div class="modal modal_compression modal_dropdown">
                      <div class="modal-window">
                        <a class="modal-close" href="#"><span></span><span></span></a>
                        <strong class="modal-title" th:text="#{bookshop.names.book_page.current_rate}">Распределение оценок</strong>
                        <div class="RatingGroup">
                          <span th:each="rating, state : ${book.ratings.starsValues}" th:remove="tag">
                            <span class="Rating" >
                              <span class="Rating-stars">
                                <span class="Rating-star Rating-star_view" th:each="count, stateStar : ${book.ratings.stars}"
                                      th:class="'Rating-star' + (${5 - stateStar.index gt state.index} ? ' Rating-star_view' : '')">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="19" height="18" viewBox="0 0 19 18">
                                    <g>
                                      <path fill="#ffc000" d="M9.5 14.925L3.629 18l1.121-6.512L0 6.875l6.564-.95L9.5 0l2.936 5.925 6.564.95-4.75 4.613L15.371 18z"></path>
                                    </g>
                                  </svg>
                                </span>
                              </span>
                              <span class="Rating-title" th:text="${rating}">1</span>
                            </span>
                            <br>
                          </span>
                        </div>
                      </div>
                    </div>
                  </button>
                </div>
                <div class="ProductCard-assessment">
                  <span class="ProductCard-titleProp" th:text="#{bookshop.names.book_page.rate_the_book}">Оцените книгу:</span>
                  <span class="Rating Rating_input" data-bookid="2121" th:attr="data-bookid = ${book.slug}">
                    <span class="Rating-stars">
                      <span th:each="star, state : ${book.ratings.myStars}" th:remove="tag">
                        <span class="Rating-star" th:class="'Rating-star' + (${star} ? ' Rating-star_view' : '')">
                          <svg xmlns="http://www.w3.org/2000/svg" width="19" height="18" viewBox="0 0 19 18">
                            <g>
                              <path fill="#ffc000" d="M9.5 14.925L3.629 18l1.121-6.512L0 6.875l6.564-.95L9.5 0l2.936 5.925 6.564.95-4.75 4.613L15.371 18z"></path>
                            </g>
                          </svg>
                        </span>
                        <input name="rating" type="radio" value="1" th:value="${state.index + 1}"/>
                      </span>
                    </span>
                  </span>
                </div>
                <div class="ProductCard-tags">
                  <span class="ProductCard-titleProp" th:text="#{bookshop.names.book_page.tags}">Тэги:</span>
                  <a style="padding: 3px" href="/tags/"
                     th:each="tag, state : ${book.tagList}"
                     th:href="@{/books/tag/{slug} (slug = ${tag.slug})}"
                     th:text="${tag.name} + (${state.last} ? '' : ', ')">tagName</a>
                </div>
                <div class="ProductCard-cost">
                  <span class="ProductCard-titleProp" th:text="#{bookshop.names.book_page.price} + ' '">Цена:</span>
                  <span class="ProductCard-priceOld"
                        th:if="${book.discount gt 0}"
                        th:text="'₽' + ${#numbers.formatDecimal(book.price, 0, 'WHITESPACE', 2 , 'POINT')}">₽300</span>
                  <span class="ProductCard-price"
                        th:with="newPrice=${book.price - book.price * book.discount / 100}"
                        th:text="'₽' + ${#numbers.formatDecimal(newPrice, 0, 'WHITESPACE', 2, 'POINT')}">₽180</span>
                </div>
                <!--+div.-info
                //+div.-cost
                //    +div.-price $55.00
                //    +div.-priceOld $115.00
                //+div.-compare
                //    +btn._default
                //        +img('change.svg','icons/card').-icon
                -->
              </div>
              <div class="ProductCard-text">
                <p th:text="${book.description}">Book description</p>
              </div>
              <div class="ProductCard-cart">
                <!--+div.-cartElement.-cartElement_amount-->
                <!--    +Amount._product-->
                <div class="ProductCard-cartElement">
                  <button class="btn btn_primary btn_outline" data-sendstatus="KEPT" data-bookid="[1111]"
                          th:attr="data-bookid='['+${book.slug}+']'" data-btntype="check" data-btnradio="buyblock" data-check="false" data-alttext="Отложена">
                    <span class="btn-icon"><img src="/assets/img/icons/heart.svg" alt="heart.svg"/></span>
                    <span class="btn-content" th:text="#{bookshop.names.book_page.postpone}">Отложить</span>
                  </button>
                </div>
                <div class="ProductCard-cartElement">
                  <button class="btn btn_primary btn_outline" data-sendstatus="CART" data-bookid="[1111]"
                          th:attr="data-bookid='['+${book.slug}+']'" data-btntype="check" data-btnradio="buyblock" data-check="false" data-alttext="В корзине">
                    <span class="btn-icon"><img src="/assets/img/icons/shopping-basket.svg" alt="shopping-basket.svg"/></span>
                    <span class="btn-content" th:text="#{bookshop.names.book_page.buy}">Купить</span>
                  </button>
                </div>
              </div>
              <div class="ProductCard-cart">
                <!--+div.-cartElement.-cartElement_amount-->
                <!--    +Amount._product-->
                <div class="ProductCard-cartElement"><a class="btn btn_primary btn_outline" href="#">
                  <span class="btn-icon"><img src="/assets/img/icons/download.svg" alt="download.svg"/></span>
                  <span class="btn-content" th:text="#{bookshop.names.book_page.download}">Скачать</span></a>
                </div>
                <div class="ProductCard-cartElement">
                  <button class="btn btn_primary btn_outline" data-sendstatus="ARCHIVED" data-bookid="[1111]" data-btntype="check" data-btnradio="buyblock" data-check="false" data-alttext="Вернуть из архива">
                    <span class="btn-icon"><img src="/assets/img/icons/archive.svg" alt="archive.svg"/></span>
                    <span class="btn-content" th:text="#{bookshop.names.book_page.to_archive}">В архив</span>
                  </button>
                </div>
              </div>

              <div id="myPopup">
                <p>Ссылки для скачивания</p>
                <div id="myPopup_string" th:each="bookFile : ${book.bookFileList}">
                  <a href="#" th:href="@{/books/download/{hash} (hash=${bookFile.hash})}"
                     th:text="${bookFile.fileType} + ' (' + ${bookFile.hash} + ')'
                     + ' - ' + ${bookFile.description}"></a>
                </div>
                <span id="myPopup_close" class="close">❌</span>
              </div>
              <div id="myOverlay"></div>

              <!--+div.-cart-->
              <!--    //+div.-cartElement.-cartElement_amount-->
              <!--    //    +Amount._product-->
              <!--    +div.-cartElement-->
              <!--        +btn('button')(data-sendstatus='UNLINK' data-bookid="[1111]")._muted Вернуть из архива-->
            </div>
          </div>
          <div class="Product-comments">
            <div class="Product-comments-header">
              <h3 class="Product-comments-title" th:text="#{bookshop.names.book_page.comments}">Отзывы
              </h3><span class="Product-comments-amount" th:text="${book.reviews.size()} + ' отзывов'">567 отзывов</span>
            </div>
          </div>
          <div class="Comments">
            <div class="Comment" th:each="review : ${book.reviews}">
              <div class="Comment-column Comment-column_pict">
                <div class="Comment-avatar">
                </div>
              </div>
              <div class="Comment-column">
                <header class="Comment-header">
                  <div>
                    <strong class="Comment-title">
                      <span th:text="${review.userName}"></span>
                      <span class="Comment-rating">
                        <span class="Rating Rating_comment">
                          <span class="Rating-star Rating-star_view" th:each="star : ${review.stars}"
                                th:class="'Rating-star' + (${star} ? ' Rating-star_view' : '')">
                          <svg xmlns="http://www.w3.org/2000/svg" width="19" height="18" viewBox="0 0 19 18">
                            <g>
                              <path fill="#ffc000" d="M9.5 14.925L3.629 18l1.121-6.512L0 6.875l6.564-.95L9.5 0l2.936 5.925 6.564.95-4.75 4.613L15.371 18z"></path>
                            </g>
                          </svg>
                        </span>
                        </span>
                      </span>
                    </strong>
                    <span class="Comment-date" th:text="${review.time}">17.04.2020 16:40</span>
                  </div>
                </header>
                <div class="Comment-content">
                  <div class="Spoiler" th:if="${review.text.length() gt 500}">
                    <div class="Spoiler-visible">
                      <p th:text="${review.text.substring(0, 500)}">text</p>
                    </div>
                    <div class="Spoiler-hide">
                      <p th:text="${review.text.substring(500)}">text</p>
                    </div>
                    <div class="Comment-footer">
                      <div th:replace="~{fragments/common_review_likes_fragment :: reviewLikesFragment}"></div>
                      <button class="Spoiler-trigger btn btn_primary btn_nr" type="button" data-showtext="Свернуть отзыв" data-hidetext="Показать отзыв полностью"
                              th:data-showtext="#{bookshop.names.buttons.hide_comment}"
                              th:data-hidetext="#{bookshop.names.buttons.show_comment}">
                      </button>
                    </div>
                  </div>
                  <div th:remove="tag" th:if="${review.text.length() le 500}">
                    <p th:text="${review.text}">text</p>
                    <div class="Comment-footer">
                      <div th:replace="~{fragments/common_review_likes_fragment :: reviewLikesFragment}"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
  <footer th:replace="~{fragments/common_footer_fragment :: footerFragment}"></footer>
  <script src="/assets/plg/jQuery/jquery-3.5.1.min.js"></script>
  <script src="/assets/js/UploadNewBookImageScript.js"></script>
  <script src="/assets/js/DownloadBookWindowScript.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
</body></html>